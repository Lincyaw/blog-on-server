---
title: alpha-beta剪枝
date: 2020-10-09 16:02:25
tags: 
	- 算法
	- 人工智能
categories: 
	- 学习
mathjax: true
---

在人工智能课上的$\alpha-\beta$剪枝有一些疑惑, 故在网上查了资料, 做了总结。

<!--more-->

# 参考地址

[详解Minimax算法与α-β剪枝](https://blog.csdn.net/wenjianmuran/article/details/90633418)

[一图流解释 Alpha-Beta 剪枝(Alpha-Beta Pruning)](https://www.7forz.com/3211/)

网上解释$\alpha-\beta$剪枝的多为解释他的过程, 并没有解释为什么这样剪枝会比较合理。在之前做力扣动态规划的时候做到博弈dp类型的题目([877. 石子游戏](https://leetcode-cn.com/problems/stone-game/))时，看[题解](https://leetcode-cn.com/problems/stone-game/solution/ji-yi-hua-di-gui-dong-tai-gui-hua-shu-xue-jie-java/)也是一知半解。

今天将这个题目的场景代入到$\alpha-\beta$剪枝当中, 希望能够加深对于这个剪枝方法的理解。



# 博弈概念描述

## 博弈树

  若把双人完备信息博弈过程用图表示出来，就得到一棵与/或树，这种与/ 或树被称为博弈树。在博弈树中，那些下一步该MAX走步的节点称为**MAX 节点**，下一步该MIN走步的节点称为**MIN 节点**。

博弈树的特点

​	(1) 博弈的初始状态是初始节点；

​	(2) 博弈树中的“或”节点和“与”节点是逐层交替出现的；

​	(3) 整个博弈过程始终站在某一方的立场上，例如MAX方。所有能使自己一方获胜的终局都是本原问题，相应的节点是可解节点；所有使对方获胜的终局都是不可解节点。 



## 极大极小过程

对于复杂的博弈问题，不可能生成整个搜索树，如国际象棋，大约有$10^{120}$个节点。一种可行的方法是用当前正在考察的节点生成一棵部分博弈树，并利用估价函数f(n)对叶节点进行静态估值。

- 对叶节点的估值方法是： 
  - 那些对MAX有利的节点，其估价函数取正值； 
  - 那些对MIN有利的节点，其估价函数取负值； 
  - 那些使双方均等的节点，其估价函数取接近于0的值。

- 为非叶节点的值，必须从叶节点开始向上倒退。 其倒退方法是：
  - 对于MAX节点，由于MAX 方总是选择估值最大的走步，因此， MAX节点的倒推值应该**取其后继节点估值的最大值。**
  - 对于MIN节点，由于MIN方总是选择使估值最小的走步，因此MIN 节点的倒推值应**取其后继节点估值的最小值**。



## 剪枝的概念 

在极大极小搜索过程中，剪去一些没用的分枝，减少了搜索空间，使得算法在同样时间内可以搜索更深层，这种技术被称为α-β剪枝。 剪枝方法:

​	(1) MAX节点（或节点）的α值为当前子节点的**最大倒推值**； 

​	(2) MIN节点（与节点）的β值为当前子节点的**最小倒推值**；

​	(3) α-β剪枝的规则如下：

​			**β剪枝:**  任何MAX节点n的**α值**大于或等于它**先辈节点的β值**，则n 以下的分枝可停止搜索，并令节点n的倒推值为α。这种剪枝称为β剪枝。

​			**α剪枝:**  任何MIN节点n的**β值**小于或等于它**先辈节点的α值**，则n 以下的分枝可停止搜索，并令节点n的倒推值为**β**。这种剪枝称为α剪枝。

# 场景描述

![https://jlice-top.oss-cn-beijing.aliyuncs.com/46ad4d30002211e98548509a4c21c90b.png](https://img-blog.csdnimg.cn/20190528095115965.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlbmppYW5tdXJhbg==,size_16,color_FFFFFF,t_70)

小圆和小方两个人每次可以拿一堆石子, 如上图中的12堆石子; 每一堆的石子数量不一样;

小圆和小方的目的就是让对方拿的石子数量越少越好, 让自己拿个数量越多越好。



在概念中对$\alpha$的定义是MAX节点（或节点）的α值为当前子节点的最大倒推值;

在这个场景中我认为就是小方在**选择最理想的石堆的情况下,** 能拿到的**最多**的石子数量。

并且$\alpha$应该越大越好, 这样小方越有可能获胜。



如下图中，在点B时，是小方选择；先不看上面标注的$\alpha \beta$，自己考虑一下在这种情况下小方能够拿到的石子数量最多是最少呢？

![base](https://img-blog.csdnimg.cn/20190528095116846.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlbmppYW5tdXJhbg==,size_16,color_FFFFFF,t_70)

很显然，小方应该走左边的路径； 因为小圆一定是会让小方拿到的石子数越少越好，因此结点3的子节点中**最小的数**就是小方能够拿到的**最大的石子数**；同理，如果走右边的路，结点C中的最小的数就是小方能拿到的最大的数：2；

$3>2$， 所以小方应该走左边的路应该拿的东西。



# 解释剪枝

在[定义](#剪枝的概念)中他们说$\alpha$是**最大倒推值**, 但是倒推值到底是什么呢?

我认为: **倒推值就是任意一名玩家, 在这个位置上能够得到的最大收益**

$\alpha$, 最大倒推值, 就是让**小方**在这个位置上的最大收益; 

$\beta$, 最小倒推值, 就是让**小圆**在这个位置上的最大收益, 也就是让小方能得到的收益最小



如下图中的正方形和圆形里都有一个数字, 即为倒推值; 在这个圆形或者正方形边上有$\alpha$和$\beta$

![full](https://img-blog.csdnimg.cn/20190528095119641.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlbmppYW5tdXJhbg==,size_16,color_FFFFFF,t_70)

因为整个博弈**过程始终站在某一方的立场上**, 这里始终站在小方的立场上, 所以在小方做选择的时候更新$\alpha$, 小圆做选择的时候更新$\beta$,  也就是每一层只更新一个符号。

那么，减掉左下方的那个12的那条路径的原因就是：

​	搜到2的时候, 在另一条路上小方已经能拿到３的石子了（$\alpha$），而在这条路上竟然还有比3还小的? 那我走这条路, 小圆铁定让我只能拿2啊, 那还不如走另一条路呢!

>  即 **α剪枝:**  
> 任何MIN节点n的**β值**(小圆能让小方拿的石子数, 他的子节点中最小的倒推值:2 )小于或等于它**先辈节点的α值**(小方走其他路能拿的石子数:3, 先辈结点的其他子节点中最大的倒推值:3)，则n 以下的分枝可停止搜索，并令节点n的倒推值为**β**(小圆就直接会选择2, 所以小方走这条路能获得收益就是2)。



删掉第二个X的原因为$\beta$剪枝

> 任何MAX节点n的**α值**(15)大于或等于它**先辈节点的β(3)值**，则n 以下的分枝可停止搜索，并令节点n的倒推值为α。这种剪枝称为β剪枝。

即, 小圆已经有一条路能够让小方获益3块石头了, 走这条路竟然能让小方有可能获益15块石头, 这能忍吗? 





其他的剪枝也是这个道理, 具体过程可以参考[这篇文章](https://blog.csdn.net/wenjianmuran/article/details/90633418), 已经非常详细了。